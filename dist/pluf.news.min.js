/*! angular-pluf 2016-05-24 */
"use strict";angular.module("pluf.news",["pluf"]).factory("PFollower",function(PObject,PException){var pFollower=function(){PObject.apply(this,arguments)};return pFollower.prototype=new PObject,pFollower}).service("$news",function($httpParamSerializerJQLike,$http,$q,PException,PFollower,PaginatorPage){this._df=[],this._getf=function(i){return this._df[i]},this._retf=function(id,d){var i=this._getf(id);return i?(i.setData(d),i):(this._df[id]=new PFollower(d),this._df[id])},this.validateFollower=function(f){var def=$q.defer(),re=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;if(re.test(f))return def.resolve({type:"email",address:f}),def.promise;var mob=/^\+?\d{10,14}$/;return mob.test(f)?(def.resolve({type:"mobile",address:f}),def.promise):(def.resolve({type:"other",address:f}),def.promise)},this.newFollower=function(f){var scope=this;return $http({method:"POST",url:"/api/newspaper/follower/new",data:$httpParamSerializerJQLike(f),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(res){return scope._retf(res.data.id,res.data)})},this.followers=function(p){var scope=this;return $http({method:"GET",url:"/api/newspaper/follower/find",params:p.getParameter()}).then(function(res){var page=new PaginatorPage(res.data);page.items=[];for(var i=0;i<res.data.counts;i++)page.items.push(scope._retf(res.data.items[i].id,res.data.items[i]));return page})},this.follower=function(i){}});